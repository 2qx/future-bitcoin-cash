const ee=globalThis||void 0||self;function Ge(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var le={exports:{}},P=typeof Reflect=="object"?Reflect:null,ve=P&&typeof P.apply=="function"?P.apply:function(t,n,r){return Function.prototype.apply.call(t,n,r)},q;P&&typeof P.ownKeys=="function"?q=P.ownKeys:Object.getOwnPropertySymbols?q=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:q=function(t){return Object.getOwnPropertyNames(t)};function He(e){console&&console.warn&&console.warn(e)}var Se=Number.isNaN||function(t){return t!==t};function p(){p.init.call(this)}le.exports=p;le.exports.once=qe;p.EventEmitter=p;p.prototype._events=void 0;p.prototype._eventsCount=0;p.prototype._maxListeners=void 0;var be=10;function X(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return be},set:function(e){if(typeof e!="number"||e<0||Se(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");be=e}});p.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};p.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Se(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ne(e){return e._maxListeners===void 0?p.defaultMaxListeners:e._maxListeners}p.prototype.getMaxListeners=function(){return Ne(this)};p.prototype.emit=function(t){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var c;if(n.length>0&&(c=n[0]),c instanceof Error)throw c;var f=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw f.context=c,f}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")ve(h,this,n);else for(var u=h.length,o=ke(h,u),r=0;r<u;++r)ve(o[r],this,n);return!0};function Ie(e,t,n,r){var i,s,c;if(X(n),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),c=s[t]),c===void 0)c=s[t]=n,++e._eventsCount;else if(typeof c=="function"?c=s[t]=r?[n,c]:[c,n]:r?c.unshift(n):c.push(n),i=Ne(e),i>0&&c.length>i&&!c.warned){c.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=t,f.count=c.length,He(f)}return e}p.prototype.addListener=function(t,n){return Ie(this,t,n,!1)};p.prototype.on=p.prototype.addListener;p.prototype.prependListener=function(t,n){return Ie(this,t,n,!0)};function Be(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Oe(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=Be.bind(r);return i.listener=n,r.wrapFn=i,i}p.prototype.once=function(t,n){return X(n),this.on(t,Oe(this,t,n)),this};p.prototype.prependOnceListener=function(t,n){return X(n),this.prependListener(t,Oe(this,t,n)),this};p.prototype.removeListener=function(t,n){var r,i,s,c,f;if(X(n),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||n));else if(typeof r!="function"){for(s=-1,c=r.length-1;c>=0;c--)if(r[c]===n||r[c].listener===n){f=r[c].listener,s=c;break}if(s<0)return this;s===0?r.shift():je(r,s),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,f||n)}return this};p.prototype.off=p.prototype.removeListener;p.prototype.removeAllListeners=function(t){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var s=Object.keys(r),c;for(i=0;i<s.length;++i)c=s[i],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[t],typeof n=="function")this.removeListener(t,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(t,n[i]);return this};function Ae(e,t,n){var r=e._events;if(r===void 0)return[];var i=r[t];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?We(i):ke(i,i.length)}p.prototype.listeners=function(t){return Ae(this,t,!0)};p.prototype.rawListeners=function(t){return Ae(this,t,!1)};p.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Re.call(e,t)};p.prototype.listenerCount=Re;function Re(e){var t=this._events;if(t!==void 0){var n=t[e];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}p.prototype.eventNames=function(){return this._eventsCount>0?q(this._events):[]};function ke(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function je(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function We(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function qe(e,t){return new Promise(function(n,r){function i(c){e.removeListener(t,s),r(c)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),n([].slice.call(arguments))}De(e,t,s,{once:!0}),t!=="error"&&Ve(e,i,{once:!0})})}function Ve(e,t,n){typeof e.on=="function"&&De(e,"error",t,n)}function De(e,t,n,r){if(typeof e.on=="function")r.once?e.once(t,n):e.on(t,n);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var fe=le.exports;const Ke=new Error("request for lock canceled");var Xe=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(c){c(s)})}return new(n||(n=Promise))(function(s,c){function f(o){try{u(r.next(o))}catch(a){c(a)}}function h(o){try{u(r.throw(o))}catch(a){c(a)}}function u(o){o.done?s(o.value):i(o.value).then(f,h)}u((r=r.apply(e,t||[])).next())})};class Je{constructor(t,n=Ke){this._value=t,this._cancelError=n,this._weightedQueues=[],this._weightedWaiters=[]}acquire(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise((n,r)=>{this._weightedQueues[t-1]||(this._weightedQueues[t-1]=[]),this._weightedQueues[t-1].push({resolve:n,reject:r}),this._dispatch()})}runExclusive(t,n=1){return Xe(this,void 0,void 0,function*(){const[r,i]=yield this.acquire(n);try{return yield t(r)}finally{i()}})}waitForUnlock(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);return new Promise(n=>{this._weightedWaiters[t-1]||(this._weightedWaiters[t-1]=[]),this._weightedWaiters[t-1].push(n),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(t){this._value=t,this._dispatch()}release(t=1){if(t<=0)throw new Error(`invalid weight ${t}: must be positive`);this._value+=t,this._dispatch()}cancel(){this._weightedQueues.forEach(t=>t.forEach(n=>n.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var t;for(let n=this._value;n>0;n--){const r=(t=this._weightedQueues[n-1])===null||t===void 0?void 0:t.shift();if(!r)continue;const i=this._value,s=n;this._value-=n,n=this._value+1,r.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(t){let n=!1;return()=>{n||(n=!0,this.release(t))}}_drainUnlockWaiters(){for(let t=this._value;t>0;t--)this._weightedWaiters[t-1]&&(this._weightedWaiters[t-1].forEach(n=>n()),this._weightedWaiters[t-1]=[])}}var Ye=function(e,t,n,r){function i(s){return s instanceof n?s:new n(function(c){c(s)})}return new(n||(n=Promise))(function(s,c){function f(o){try{u(r.next(o))}catch(a){c(a)}}function h(o){try{u(r.throw(o))}catch(a){c(a)}}function u(o){o.done?s(o.value):i(o.value).then(f,h)}u((r=r.apply(e,t||[])).next())})};class ze{constructor(t){this._semaphore=new Je(1,t)}acquire(){return Ye(this,void 0,void 0,function*(){const[,t]=yield this._semaphore.acquire();return t})}runExclusive(t){return this._semaphore.runExclusive(()=>t())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}var ie={exports:{}},te,Ee;function Qe(){if(Ee)return te;Ee=1;var e=1e3,t=e*60,n=t*60,r=n*24,i=r*7,s=r*365.25;te=function(o,a){a=a||{};var l=typeof o;if(l==="string"&&o.length>0)return c(o);if(l==="number"&&isFinite(o))return a.long?h(o):f(o);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))};function c(o){if(o=String(o),!(o.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(a){var l=parseFloat(a[1]),E=(a[2]||"ms").toLowerCase();switch(E){case"years":case"year":case"yrs":case"yr":case"y":return l*s;case"weeks":case"week":case"w":return l*i;case"days":case"day":case"d":return l*r;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*t;case"seconds":case"second":case"secs":case"sec":case"s":return l*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function f(o){var a=Math.abs(o);return a>=r?Math.round(o/r)+"d":a>=n?Math.round(o/n)+"h":a>=t?Math.round(o/t)+"m":a>=e?Math.round(o/e)+"s":o+"ms"}function h(o){var a=Math.abs(o);return a>=r?u(o,a,r,"day"):a>=n?u(o,a,n,"hour"):a>=t?u(o,a,t,"minute"):a>=e?u(o,a,e,"second"):o+" ms"}function u(o,a,l,E){var D=a>=l*1.5;return Math.round(o/l)+" "+E+(D?"s":"")}return te}function Ze(e){n.debug=n,n.default=n,n.coerce=h,n.disable=s,n.enable=i,n.enabled=c,n.humanize=Qe(),n.destroy=u,Object.keys(e).forEach(o=>{n[o]=e[o]}),n.names=[],n.skips=[],n.formatters={};function t(o){let a=0;for(let l=0;l<o.length;l++)a=(a<<5)-a+o.charCodeAt(l),a|=0;return n.colors[Math.abs(a)%n.colors.length]}n.selectColor=t;function n(o){let a,l=null,E,D;function y(...b){if(!y.enabled)return;const T=y,L=Number(new Date),Y=L-(a||L);T.diff=Y,T.prev=a,T.curr=L,a=L,b[0]=n.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let $=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(M,z)=>{if(M==="%%")return"%";$++;const B=n.formatters[z];if(typeof B=="function"){const Q=b[$];M=B.call(T,Q),b.splice($,1),$--}return M}),n.formatArgs.call(T,b),(T.log||n.log).apply(T,b)}return y.namespace=o,y.useColors=n.useColors(),y.color=n.selectColor(o),y.extend=r,y.destroy=n.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(E!==n.namespaces&&(E=n.namespaces,D=n.enabled(o)),D),set:b=>{l=b}}),typeof n.init=="function"&&n.init(y),y}function r(o,a){const l=n(this.namespace+(typeof a>"u"?":":a)+o);return l.log=this.log,l}function i(o){n.save(o),n.namespaces=o,n.names=[],n.skips=[];let a;const l=(typeof o=="string"?o:"").split(/[\s,]+/),E=l.length;for(a=0;a<E;a++)l[a]&&(o=l[a].replace(/\*/g,".*?"),o[0]==="-"?n.skips.push(new RegExp("^"+o.slice(1)+"$")):n.names.push(new RegExp("^"+o+"$")))}function s(){const o=[...n.names.map(f),...n.skips.map(f).map(a=>"-"+a)].join(",");return n.enable(""),o}function c(o){if(o[o.length-1]==="*")return!0;let a,l;for(a=0,l=n.skips.length;a<l;a++)if(n.skips[a].test(o))return!1;for(a=0,l=n.names.length;a<l;a++)if(n.names[a].test(o))return!0;return!1}function f(o){return o.toString().substring(2,o.toString().length-2).replace(/\.\*\?$/,"*")}function h(o){return o instanceof Error?o.stack||o.message:o}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var et=Ze;(function(e,t){var n={GITHUB_STATE:"/home/runner/work/_temp/_runner_file_commands/save_state_efc4bd3f-3347-4a4c-85c2-1e9b037cc86c",npm_package_dependencies_rehype_slug:"^6.0.0",STATS_TRP:"true",DEPLOYMENT_BASEPATH:"/opt/runner",DOTNET_NOLOGO:"1",npm_package_devDependencies_vitest:"^1.2.0",USER:"runner",npm_config_user_agent:"pnpm/8.15.5 npm/? node/v21.7.3 linux x64",CI:"true",RUNNER_ENVIRONMENT:"github-hosted",GITHUB_ENV:"/home/runner/work/_temp/_runner_file_commands/set_env_efc4bd3f-3347-4a4c-85c2-1e9b037cc86c",PIPX_HOME:"/opt/pipx",npm_package_devDependencies__sveltejs_vite_plugin_svelte:"^3.0.0",npm_package_devDependencies_vite:"^5.0.3",npm_package_dependencies__jsdevtools_rehype_toc:"^3.0.2",npm_node_execpath:"/opt/hostedtoolcache/node/21.7.3/x64/bin/node",JAVA_HOME_8_X64:"/usr/lib/jvm/temurin-8-jdk-amd64",SHLVL:"1",HOME:"/home/runner",RUNNER_TEMP:"/home/runner/work/_temp",GITHUB_EVENT_PATH:"/home/runner/work/_temp/_github_workflow/event.json",npm_package_devDependencies_eslint_config_prettier:"^9.1.0",npm_package_devDependencies_eslint_plugin_svelte:"^2.36.0",JAVA_HOME_11_X64:"/usr/lib/jvm/temurin-11-jdk-amd64",PIPX_BIN_DIR:"/opt/pipx_bin",GITHUB_REPOSITORY_OWNER:"2qx",npm_package_devDependencies__sveltejs_adapter_static:"^3.0.4",GRADLE_HOME:"/usr/share/gradle-8.10",ANDROID_NDK_LATEST_HOME:"/usr/local/lib/android/sdk/ndk/27.0.12077973",JAVA_HOME_21_X64:"/usr/lib/jvm/temurin-21-jdk-amd64",STATS_RDCL:"true",GITHUB_RETENTION_DAYS:"90",npm_package_devDependencies_svelte_check:"^3.6.0",GITHUB_REPOSITORY_OWNER_ID:"57997077",POWERSHELL_DISTRIBUTION_CHANNEL:"GitHub-Actions-ubuntu22",AZURE_EXTENSION_DIR:"/opt/az/azcliextensions",GITHUB_HEAD_REF:"",npm_package_scripts_check:"svelte-kit sync && svelte-check --tsconfig ./tsconfig.json",npm_package_devDependencies__fontsource_fira_mono:"^4.5.10",SYSTEMD_EXEC_PID:"592",GITHUB_GRAPHQL_URL:"https://api.github.com/graphql",npm_package_devDependencies_typescript:"^5.5.2",GOROOT_1_20_X64:"/opt/hostedtoolcache/go/1.20.14/x64",NVM_DIR:"/home/runner/.nvm",DOTNET_SKIP_FIRST_TIME_EXPERIENCE:"1",GOROOT_1_21_X64:"/opt/hostedtoolcache/go/1.21.13/x64",JAVA_HOME_17_X64:"/usr/lib/jvm/temurin-17-jdk-amd64",ImageVersion:"20240818.1.0",npm_package_scripts_dev:"vite dev",npm_package_devDependencies_prettier:"^3.1.1",npm_package_dependencies__macfja_svelte_persistent_store:"^2.4.1",RUNNER_OS:"Linux",GITHUB_API_URL:"https://api.github.com",GOROOT_1_22_X64:"/opt/hostedtoolcache/go/1.22.6/x64",SWIFT_PATH:"/usr/share/swift/usr/bin",npm_package_type:"module",RUNNER_USER:"runner",STATS_V3PS:"true",CHROMEWEBDRIVER:"/usr/local/share/chromedriver-linux64",JOURNAL_STREAM:"8:18363",GITHUB_WORKFLOW:"Deploy app",_:"/home/runner/setup-pnpm/node_modules/.bin/pnpm",npm_package_scripts_check_watch:"svelte-kit sync && svelte-check --tsconfig ./tsconfig.json --watch",npm_package_devDependencies_vite_plugin_node_polyfills:"^0.22.0",npm_package_scripts_lint:"prettier --check . && eslint .",npm_config_registry:"https://registry.npmjs.org/",ACTIONS_RUNNER_ACTION_ARCHIVE_CACHE:"/opt/actionarchivecache",STATS_D:"true",GITHUB_RUN_ID:"10512666728",STATS_VMFE:"true",npm_package_dependencies_mdsvex:"^0.11.2",GITHUB_REF_TYPE:"branch",BOOTSTRAP_HASKELL_NONINTERACTIVE:"1",GITHUB_WORKFLOW_SHA:"9f1120aa4688bad433158f3d3b045d06498908a3",GITHUB_BASE_REF:"",ImageOS:"ubuntu22",GITHUB_WORKFLOW_REF:"2qx/future-bitcoin-cash/.github/workflows/cd.yml@refs/heads/main",PERFLOG_LOCATION_SETTING:"RUNNER_PERFLOG",GITHUB_ACTION_REPOSITORY:"",npm_config_node_gyp:"/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/dist/node_modules/node-gyp/bin/node-gyp.js",PATH:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/packages/app/node_modules/.bin:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/dist/node-gyp-bin:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.bin:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.bin:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/dist/node-gyp-bin:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.bin:/opt/hostedtoolcache/node/21.7.3/x64/bin:/home/runner/setup-pnpm/node_modules/.bin:/snap/bin:/home/runner/.local/bin:/opt/pipx_bin:/home/runner/.cargo/bin:/home/runner/.config/composer/vendor/bin:/usr/local/.ghcup/bin:/home/runner/.dotnet/tools:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin",ANT_HOME:"/usr/share/ant",DOTNET_MULTILEVEL_LOOKUP:"0",RUNNER_TRACKING_ID:"github_9fafed79-9022-4c20-81a0-6c849ae7f6fc",INVOCATION_ID:"4b5cc5267e754fbdb6e0cfb913412f20",RUNNER_TOOL_CACHE:"/opt/hostedtoolcache",NODE:"/opt/hostedtoolcache/node/21.7.3/x64/bin/node",npm_package_name:"@fbch/app",npm_package_devDependencies_typescript_eslint:"^8.0.0-alpha.20",npm_package_dependencies__electrum_cash_network:"3.3.0",GITHUB_ACTION:"__run_4",GITHUB_RUN_NUMBER:"13",GITHUB_TRIGGERING_ACTOR:"2qx",RUNNER_ARCH:"X64",XDG_RUNTIME_DIR:"/run/user/1001",AGENT_TOOLSDIRECTORY:"/opt/hostedtoolcache",npm_config_frozen_lockfile:"",LANG:"C.UTF-8",VCPKG_INSTALLATION_ROOT:"/usr/local/share/vcpkg",npm_package_devDependencies_eslint:"^9.0.0",CONDA:"/usr/share/miniconda",RUNNER_NAME:"GitHub Actions 8",XDG_CONFIG_HOME:"/home/runner/.config",STATS_VMD:"true",GITHUB_REF_NAME:"main",GITHUB_REPOSITORY:"2qx/future-bitcoin-cash",STATS_D_D:"true",npm_package_dependencies__fbch_lib:"workspace:*",npm_lifecycle_script:"vite build",STATS_UE:"true",ANDROID_NDK_ROOT:"/usr/local/lib/android/sdk/ndk/27.0.12077973",GITHUB_ACTION_REF:"",DEBIAN_FRONTEND:"noninteractive",npm_package_scripts_test:"vitest",npm_package_devDependencies__sveltejs_kit:"^2.0.0",GITHUB_REPOSITORY_ID:"764404708",GITHUB_ACTIONS:"true",NODE_PATH:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.pnpm/vite@5.4.2_@types+node@18.19.45/node_modules/vite/bin/node_modules:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.pnpm/vite@5.4.2_@types+node@18.19.45/node_modules/vite/node_modules:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.pnpm/vite@5.4.2_@types+node@18.19.45/node_modules:/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/node_modules/.pnpm/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/bin/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/bin/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules:/home/runner/setup-pnpm/node_modules/.pnpm/node_modules",npm_package_version:"0.0.1",npm_lifecycle_event:"build",GITHUB_REF_PROTECTED:"false",npm_package_scripts_build:"vite build",npm_package_devDependencies_svelte:"^4.2.7",npm_package_devDependencies_tslib:"^2.4.1",GITHUB_WORKSPACE:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash",ACCEPT_EULA:"Y",GITHUB_JOB:"deploy",RUNNER_PERFLOG:"/home/runner/perflog",GITHUB_SHA:"9f1120aa4688bad433158f3d3b045d06498908a3",GITHUB_RUN_ATTEMPT:"1",GITHUB_REF:"refs/heads/main",GITHUB_ACTOR:"2qx",ANDROID_SDK_ROOT:"/usr/local/lib/android/sdk",npm_package_devDependencies_globals:"^15.0.0",LEIN_HOME:"/usr/local/lib/lein",npm_package_scripts_format:"prettier --write .",GITHUB_PATH:"/home/runner/work/_temp/_runner_file_commands/add_path_efc4bd3f-3347-4a4c-85c2-1e9b037cc86c",JAVA_HOME:"/usr/lib/jvm/temurin-11-jdk-amd64",PWD:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/packages/app",GITHUB_ACTOR_ID:"57997077",RUNNER_WORKSPACE:"/home/runner/work/future-bitcoin-cash",npm_package_dependencies_svelte_preprocess:"^6.0.1",npm_execpath:"/home/runner/setup-pnpm/node_modules/.pnpm/pnpm@8.15.5/node_modules/pnpm/bin/pnpm.cjs",HOMEBREW_CLEANUP_PERIODIC_FULL_DAYS:"3650",GITHUB_EVENT_NAME:"push",HOMEBREW_NO_AUTO_UPDATE:"1",ANDROID_HOME:"/usr/local/lib/android/sdk",GITHUB_SERVER_URL:"https://github.com",GECKOWEBDRIVER:"/usr/local/share/gecko_driver",LEIN_JAR:"/usr/local/lib/lein/self-installs/leiningen-2.11.2-standalone.jar",GHCUP_INSTALL_BASE_PREFIX:"/usr/local",GITHUB_OUTPUT:"/home/runner/work/_temp/_runner_file_commands/set_output_efc4bd3f-3347-4a4c-85c2-1e9b037cc86c",npm_config_recursive:"true",EDGEWEBDRIVER:"/usr/local/share/edge_driver",STATS_EXT:"true",PNPM_SCRIPT_SRC_DIR:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash/packages/app",npm_package_devDependencies__neoconfetti_svelte:"^1.0.0",npm_package_devDependencies__sveltejs_adapter_auto:"^3.0.0",npm_command:"run-script",ANDROID_NDK:"/usr/local/lib/android/sdk/ndk/27.0.12077973",SGX_AESM_ADDR:"1",CHROME_BIN:"/usr/bin/google-chrome",npm_package_scripts_preview:"vite preview",npm_package_devDependencies_prettier_plugin_svelte:"^3.1.2",SELENIUM_JAR_PATH:"/usr/share/java/selenium-server.jar",PNPM_HOME:"/home/runner/setup-pnpm/node_modules/.bin",STATS_EXTP:"https://provjobdsettingscdn.blob.core.windows.net/settings/provjobdsettings-0.5.181+6/provjobd.data",ANDROID_NDK_HOME:"/usr/local/lib/android/sdk/ndk/27.0.12077973",GITHUB_STEP_SUMMARY:"/home/runner/work/_temp/_runner_file_commands/step_summary_efc4bd3f-3347-4a4c-85c2-1e9b037cc86c",INIT_CWD:"/home/runner/work/future-bitcoin-cash/future-bitcoin-cash",npm_package_devDependencies__types_eslint:"^8.56.7",NODE_ENV:"production"};t.formatArgs=i,t.save=s,t.load=c,t.useColors=r,t.storage=f(),t.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;u.splice(1,0,o,"color: inherit");let a=0,l=0;u[0].replace(/%[a-zA-Z%]/g,E=>{E!=="%%"&&(a++,E==="%c"&&(l=a))}),u.splice(l,0,o)}t.log=console.debug||console.log||(()=>{});function s(u){try{u?t.storage.setItem("debug",u):t.storage.removeItem("debug")}catch{}}function c(){let u;try{u=t.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=n.DEBUG),u}function f(){try{return localStorage}catch{}}e.exports=et(t);const{formatters:h}=e.exports;h.j=function(u){try{return JSON.stringify(u)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}}})(ie,ie.exports);var tt=ie.exports;const F=Ge(tt);function J(e){return nt.test(e)}var nt=/^-?[0-9]+$/;function rt(e){return it.test(e)}var it=/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/;function ot(e,t){var n=parseFloat(e),r=String(n),i=we(e),s=we(r);if(i===s)return!0;if(t?.approx===!0){var c=14;if(!J(e)&&s.length>=c&&i.startsWith(s.substring(0,c)))return!0}return!1}var G=function(e){return e.underflow="underflow",e.overflow="overflow",e.truncate_integer="truncate_integer",e.truncate_float="truncate_float",e}({});function st(e){if(!ot(e,{approx:!1})){if(J(e))return G.truncate_integer;var t=parseFloat(e);return isFinite(t)?t===0?G.underflow:G.truncate_float:G.overflow}}function we(e){return e.replace(ct,"").replace(ut,"").replace(dt,"").replace(at,"")}var ct=/[eE][+-]?\d+$/,at=/^-?(0*)?/,ut=/\./,dt=/0+$/;function U(e){"@babel/helpers - typeof";return U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(e)}function lt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Le(r.key),r)}}function ht(e,t,n){return t&&ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pt(e,t,n){return t=Le(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e){var t=_t(e,"string");return U(t)==="symbol"?t:String(t)}function _t(e,t){if(U(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(U(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mt=function(){function e(t){if(lt(this,e),pt(this,"isLosslessNumber",!0),!rt(t))throw new Error('Invalid number (value: "'+t+'")');this.value=t}return ht(e,[{key:"valueOf",value:function(){var n=st(this.value);if(n===void 0||n===G.truncate_float)return parseFloat(this.value);if(J(this.value))return BigInt(this.value);throw new Error("Cannot safely convert to number: "+"the value '".concat(this.value,"' would ").concat(n," and become ").concat(parseFloat(this.value)))}},{key:"toString",value:function(){return this.value}}]),e}();function vt(e){return e&&U(e)==="object"&&e.isLosslessNumber===!0||!1}function bt(e){return new mt(e)}function Et(e){return J(e)?BigInt(e):parseFloat(e)}function oe(e){"@babel/helpers - typeof";return oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(e)}function wt(e,t){return he({"":e},"",e,t)}function he(e,t,n,r){return Array.isArray(n)?r.call(e,t,gt(n,r)):n&&oe(n)==="object"&&!vt(n)?r.call(e,t,Ct(n,r)):r.call(e,t,n)}function Ct(e,t){return Object.keys(e).forEach(function(n){var r=he(e,n,e[n],t);r!==void 0?e[n]=r:delete e[n]}),e}function gt(e,t){for(var n=0;n<e.length;n++)e[n]=he(e,n+"",e[n],t);return e}function se(e){"@babel/helpers - typeof";return se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(e)}function ne(e){return Nt(e)||St(e)||Tt(e)||yt()}function yt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tt(e,t){if(e){if(typeof e=="string")return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ce(e,t)}}function St(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nt(e){if(Array.isArray(e))return ce(e)}function ce(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bt,r=0,i=f();return D(i),b(),t?wt(i,t):i;function s(){if(e.charCodeAt(r)===Lt){r++,u();for(var d={},_=!0;r<e.length&&e.charCodeAt(r)!==ge;){_?_=!1:(l(),u());var w=r,N=o();N===void 0&&Y(),u(),E();var O=f();O===void 0&&Q(),Object.prototype.hasOwnProperty.call(d,N)&&!ae(O,d[N])&&$(N,w+1),d[N]=O}return e.charCodeAt(r)!==ge&&me(),r++,d}}function c(){if(e.charCodeAt(r)===$t){r++,u();for(var d=[],_=!0;r<e.length&&e.charCodeAt(r)!==ye;){_?_=!1:l();var w=f();y(w),d.push(w)}return e.charCodeAt(r)!==ye&&M(),r++,d}}function f(){var d,_,w,N,O,Z;u();var xe=(d=(_=(w=(N=(O=(Z=o())!==null&&Z!==void 0?Z:a())!==null&&O!==void 0?O:s())!==null&&N!==void 0?N:c())!==null&&w!==void 0?w:h("true",!0))!==null&&_!==void 0?_:h("false",!1))!==null&&d!==void 0?d:h("null",null);return u(),xe}function h(d,_){if(e.slice(r,r+d.length)===d)return r+=d.length,_}function u(){for(;Ot(e.charCodeAt(r));)r++}function o(){if(e.charCodeAt(r)===re){r++;for(var d="";r<e.length&&e.charCodeAt(r)!==re;){if(e.charCodeAt(r)===Dt){var _=e[r+1],w=kt[_];w!==void 0?(d+=w,r++):_==="u"?j(e.charCodeAt(r+2))&&j(e.charCodeAt(r+3))&&j(e.charCodeAt(r+4))&&j(e.charCodeAt(r+5))?(d+=String.fromCharCode(parseInt(e.slice(r+2,r+6),16)),r+=5):Ue(r):B(r)}else Rt(e.charCodeAt(r))?d+=e[r]:z(e[r]);r++}return L(),r++,d}}function a(){var d=r;if(e.charCodeAt(r)===Te&&(r++,T(d)),e.charCodeAt(r)===pe)r++;else if(At(e.charCodeAt(r)))for(r++;W(e.charCodeAt(r));)r++;if(e.charCodeAt(r)===Bt)for(r++,T(d);W(e.charCodeAt(r));)r++;if(e.charCodeAt(r)===Kt||e.charCodeAt(r)===Vt)for(r++,(e.charCodeAt(r)===Te||e.charCodeAt(r)===xt)&&r++,T(d);W(e.charCodeAt(r));)r++;if(r>d)return n(e.slice(d,r))}function l(){if(e.charCodeAt(r)!==Ht)throw new SyntaxError("Comma ',' expected after value ".concat(S()));r++}function E(){if(e.charCodeAt(r)!==jt)throw new SyntaxError("Colon ':' expected after property name ".concat(S()));r++}function D(d){if(d===void 0)throw new SyntaxError("JSON value expected ".concat(S()))}function y(d){if(d===void 0)throw new SyntaxError("Array item expected ".concat(S()))}function b(){if(r<e.length)throw new SyntaxError("Expected end of input ".concat(S()))}function T(d){if(!W(e.charCodeAt(r))){var _=e.slice(d,r);throw new SyntaxError("Invalid number '".concat(_,"', expecting a digit ").concat(S()))}}function L(){if(e.charCodeAt(r)!==re)throw new SyntaxError(`End of string '"' expected `.concat(S()))}function Y(){throw new SyntaxError("Quoted object key expected ".concat(S()))}function $(d,_){throw new SyntaxError("Duplicate key '".concat(d,"' encountered at position ").concat(_))}function me(){throw new SyntaxError("Quoted object key or end of object '}' expected ".concat(S()))}function M(){throw new SyntaxError("Array item or end of array ']' expected ".concat(S()))}function z(d){throw new SyntaxError("Invalid character '".concat(d,"' ").concat(x()))}function B(d){var _=e.slice(d,d+2);throw new SyntaxError("Invalid escape character '".concat(_,"' ").concat(x()))}function Q(){throw new SyntaxError("Object value expected after ':' ".concat(x()))}function Ue(d){for(var _=d+2;/\w/.test(e[_]);)_++;var w=e.slice(d,_);throw new SyntaxError("Invalid unicode character '".concat(w,"' ").concat(x()))}function x(){return"at position ".concat(r)}function Me(){return r<e.length?"but got '".concat(e[r],"'"):"but reached end of input"}function S(){return Me()+" "+x()}}function Ot(e){return e===Ft||e===Pt||e===Ut||e===Mt}function j(e){return e>=pe&&e<=_e||e>=Wt&&e<=Xt||e>=qt&&e<=Jt}function W(e){return e>=pe&&e<=_e}function At(e){return e>=Gt&&e<=_e}function Rt(e){return e>=32&&e<=1114111}function ae(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every(function(r,i){return ae(r,t[i])});if(Ce(e)&&Ce(t)){var n=ne(new Set([].concat(ne(Object.keys(e)),ne(Object.keys(t)))));return n.every(function(r){return ae(e[r],t[r])})}return!1}function Ce(e){return se(e)==="object"&&e!==null}var kt={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},Dt=92,Lt=123,ge=125,$t=91,ye=93,Ft=32,Pt=10,Ut=9,Mt=13,re=34,xt=43,Te=45,pe=48,Gt=49,_e=57,Ht=44,Bt=46,jt=58,Wt=65,qt=97,Vt=69,Kt=101,Xt=70,Jt=102,R=null;typeof WebSocket<"u"?R=WebSocket:typeof MozWebSocket<"u"?R=MozWebSocket:typeof ee<"u"?R=ee.WebSocket||ee.MozWebSocket:typeof window<"u"?R=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(R=self.WebSocket||self.MozWebSocket);function I(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}const k={client:F("electrum-cash:client "),cluster:F("electrum-cash:cluster"),errors:F("electrum-cash:error  "),warning:F("electrum-cash:warning"),network:F("electrum-cash:network"),ping:F("electrum-cash:pulses ")};k.client.color="2";k.cluster.color="3";k.errors.color="9";k.warning.color="13";k.network.color="4";k.ping.color="8";var m=k;class Yt{static buildRequestObject(t,n,r){return JSON.stringify({method:t,params:n,id:r})}static get versionRegexp(){return/^\d+(\.\d+)+$/}static get statementDelimiter(){return`
`}}var A=Yt,$e={};I($e,"isVersionRejected",()=>Fe);I($e,"isVersionNegotiated",()=>zt);const Fe=function(e){return"error"in e},zt=function(e){return"software"in e&&"protocol"in e};var Pe={};I(Pe,"ElectrumTransport",()=>C);I(Pe,"DefaultParameters",()=>g);var H={};I(H,"ClusterOrder",()=>V);I(H,"ClusterDistribution",()=>K);I(H,"ClusterStatus",()=>ue);I(H,"ClientState",()=>de);I(H,"ConnectionStatus",()=>v);var V;(function(e){e[e.RANDOM=0]="RANDOM",e[e.PRIORITY=1]="PRIORITY"})(V||(V={}));var K;(function(e){e[e.ALL=0]="ALL"})(K||(K={}));var ue;(function(e){e[e.DISABLED=0]="DISABLED",e[e.DEGRADED=1]="DEGRADED",e[e.READY=2]="READY"})(ue||(ue={}));var de;(function(e){e[e.UNAVAILABLE=0]="UNAVAILABLE",e[e.AVAILABLE=1]="AVAILABLE"})(de||(de={}));var v;(function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTING=2]="DISCONNECTING",e[e.CONNECTING=3]="CONNECTING",e[e.RECONNECTING=4]="RECONNECTING"})(v||(v={}));const C={TCP:{Port:50001,Scheme:"tcp"},TCP_TLS:{Port:50002,Scheme:"tcp_tls"},WS:{Port:50003,Scheme:"ws"},WSS:{Port:50004,Scheme:"wss"}},g={PORT:C.TCP_TLS.Port,TRANSPORT_SCHEME:C.TCP_TLS.Scheme,RECONNECT:5e3,TIMEOUT:3e4,PING_INTERVAL:1e3,CLUSTER_CONFIDENCE:1,CLUSTER_DISTRIBUTION:K.ALL,CLUSTER_ORDER:V.RANDOM,USE_BIG_INT:!1};class Qt extends fe.EventEmitter{connect(t,n,r,i){if(this.tcpSocket||this.webSocket)throw new Error("Cannot initiate a new socket connection when an existing connection exists");this.timers.disconnect=setTimeout(()=>this.disconnectOnTimeout(t,n,i),i),this.once("connect",this.clearDisconnectTimerOnTimeout);const s={[C.TCP.Scheme]:"a TCP Socket",[C.TCP_TLS.Scheme]:"an encrypted TCP socket",[C.WS.Scheme]:"a WebSocket",[C.WSS.Scheme]:"an encrypted WebSocket"};if(m.network(`Initiating ${s[r]} connection to '${t}:${n}'.`),r===C.TCP.Scheme||r===C.TCP_TLS.Scheme){if(r===C.TCP_TLS.Scheme){const c={rejectUnauthorized:!1};$4QiMX$isIP(t)||(c.serverName=t),this.tcpSocket=$4QiMX$connect(n,t,c),this.tcpSocket.once("secureConnect",()=>{if(!(this.tcpSocket instanceof $4QiMX$TLSSocket))return;this.tcpSocket.authorizationError==="DEPTH_ZERO_SELF_SIGNED_CERT"&&m.warning(`Connection to ${t}:${n} uses a self-signed certificate`)}),this.tcpSocket.on("secureConnect",this.onConnect.bind(this,s[r],t,n))}else this.tcpSocket=$4QiMX$connect1({host:t,port:n}),this.tcpSocket.on("connect",this.onConnect.bind(this,s[r],t,n));this.tcpSocket.setEncoding("utf8"),this.tcpSocket.setKeepAlive(!0,0),this.tcpSocket.setNoDelay(!0),this.tcpSocket.on("error",this.eventForwarders.tcpError)}else if(r===C.WS.Scheme||r===C.WSS.Scheme)r===C.WSS.Scheme?this.webSocket=new R(`wss://${t}:${n}`):this.webSocket=new R(`ws://${t}:${n}`),this.webSocket.addEventListener("open",this.onConnect.bind(this,s[r],t,n)),this.webSocket.addEventListener("error",this.eventForwarders.wsError);else throw new Error("Incorrect transport specified")}onConnect(t,n,r){this.onConnectHasRun||(m.network(`Established ${t} connection with '${n}:${r}'.`),typeof this.tcpSocket<"u"?(this.tcpSocket.addListener("close",this.eventForwarders.disconnect),this.tcpSocket.addListener("data",this.eventForwarders.tcpData)):typeof this.webSocket<"u"&&(this.webSocket.addEventListener("close",this.eventForwarders.disconnect),this.webSocket.addEventListener("message",this.eventForwarders.wsData)),this.onConnectHasRun=!0,this.emit("connect"))}clearDisconnectTimerOnTimeout(){this.timers.disconnect&&clearTimeout(this.timers.disconnect)}disconnect(){if(this.clearDisconnectTimerOnTimeout(),this.tcpSocket)this.tcpSocket.removeListener("close",this.eventForwarders.disconnect),this.tcpSocket.removeListener("data",this.eventForwarders.tcpData),this.tcpSocket.removeListener("error",this.eventForwarders.tcpError),this.tcpSocket.destroy(),this.tcpSocket=void 0;else if(this.webSocket)try{this.webSocket.removeEventListener("close",this.eventForwarders.disconnect),this.webSocket.removeEventListener("message",this.eventForwarders.wsData),this.webSocket.removeEventListener("error",this.eventForwarders.wsError),this.webSocket.close()}catch{}finally{this.webSocket=void 0}this.onConnectHasRun=!1,this.emit("disconnect")}write(t,n){if(this.tcpSocket)return this.tcpSocket.write(t,n);if(this.webSocket)return this.webSocket.send(t,n),!0;throw new Error("Cannot write to socket when there is no active connection")}disconnectOnTimeout(t,n,r){this.removeListener("connect",this.clearDisconnectTimerOnTimeout);const i={code:"ETIMEDOUT",message:`Connection to '${t}:${n}' timed out after ${r} milliseconds`};this.emit("error",i),this.disconnect()}constructor(...t){super(...t),this.timers={},this.onConnectHasRun=!1,this.eventForwarders={disconnect:()=>this.emit("disconnect"),tcpData:n=>this.emit("data",n),wsData:n=>this.emit("data",`${n.data}
`),tcpError:n=>this.emit("error",n),wsError:n=>this.emit("error",n.error)}}}var Zt=Qt;class en extends fe.EventEmitter{constructor(t,n,r,i=g.PORT,s=g.TRANSPORT_SCHEME,c=g.TIMEOUT,f=g.PING_INTERVAL,h=g.RECONNECT,u=g.USE_BIG_INT){if(super(),this.application=t,this.version=n,this.host=r,this.port=i,this.scheme=s,this.timeout=c,this.pingInterval=f,this.reconnectInterval=h,this.useBigInt=u,this.timers={},this.verifications=[],this.status=v.DISCONNECTED,this.messageBuffer="",!A.versionRegexp.test(n))throw new Error(`Provided version string (${n}) is not a valid protocol version number.`);this.createSocket(),typeof document<"u"&&document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this))}get hostIdentifier(){return`${this.host}:${this.port}`}createSocket(){this.socket=new Zt,this.socket.on("connect",this.onSocketConnect.bind(this)),this.socket.on("disconnect",this.onSocketDisconnect.bind(this)),this.socket.on("data",this.parseMessageChunk.bind(this))}destroySocket(){this.socket.disconnect()}parseMessageChunk(t){for(this.lastReceivedTimestamp=Date.now(),this.verifications.forEach(n=>clearTimeout(n)),this.verifications.length=0,this.messageBuffer+=t;this.messageBuffer.includes(A.statementDelimiter);){const n=this.messageBuffer.split(A.statementDelimiter);for(;n.length>1;){const r=String(n.shift());let i=It(r,null,this.useBigInt?Et:parseFloat);for(Array.isArray(i)||(i=[i]);i.length>0;){const s=i.shift();if(s.id==="versionNegotiation"){s.error?this.emit("version",{error:s.error}):this.emit("version",{software:s.result[0],protocol:s.result[1]});continue}s.id!=="keepAlive"&&this.emit("statement",s)}}this.messageBuffer=n.shift()||""}}ping(){m.ping(`Sending keep-alive ping to '${this.hostIdentifier}'`);const t=A.buildRequestObject("server.ping",[],"keepAlive");return this.send(t)}async connect(){if(this.status===v.CONNECTED)return;this.status=v.CONNECTING;const t=(n,r)=>{const i=c=>{this.status=v.DISCONNECTED,r(c)};this.socket.removeAllListeners("error"),this.socket.once("error",i);const s=()=>{m.network(`Requesting protocol version ${this.version} with '${this.hostIdentifier}'.`),this.socket.removeListener("error",i);const c=A.buildRequestObject("server.version",[this.application,this.version],"versionNegotiation"),f=h=>{if(Fe(h)){this.disconnect(!0);const u="unsupported protocol version.";m.errors(`Failed to connect with ${this.hostIdentifier} due to ${u}`),r(u)}else if(h.protocol!==this.version&&`${h.protocol}.0`!==this.version&&`${h.protocol}.0.0`!==this.version){this.disconnect(!0);const u=`incompatible protocol version negotiated (${h.protocol} !== ${this.version}).`;m.errors(`Failed to connect with ${this.hostIdentifier} due to ${u}`),r(u)}else m.network(`Negotiated protocol version ${h.protocol} with '${this.hostIdentifier}', powered by ${h.software}.`),this.status=v.CONNECTED,this.emit("connect"),n()};this.once("version",f),this.send(c)};this.socket.once("connect",s),this.socket.on("error",this.onSocketError.bind(this)),this.socket.connect(this.host,this.port,this.scheme,this.timeout)};await new Promise(t)}async reconnect(){await this.clearReconnectTimer(),m.network(`Trying to reconnect to '${this.hostIdentifier}'..`),this.status=v.RECONNECTING,this.destroySocket(),this.createSocket();try{await this.connect()}catch{}}clearReconnectTimer(){this.timers.reconnect&&clearTimeout(this.timers.reconnect),this.timers.reconnect=void 0}clearKeepAliveTimer(){this.timers.keepAlive&&clearTimeout(this.timers.keepAlive),this.timers.keepAlive=void 0}setupKeepAliveTimer(){this.timers.keepAlive||(this.timers.keepAlive=setTimeout(this.ping.bind(this),this.pingInterval))}async disconnect(t=!1,n=!0){if(this.status===v.DISCONNECTED&&!t)return!1;n&&(this.status=v.DISCONNECTING),await this.clearKeepAliveTimer(),await this.clearReconnectTimer();const r=i=>{this.once("disconnect",()=>i(!0)),this.destroySocket()};return new Promise(r)}async handleVisibilityChange(){document.visibilityState==="hidden"&&this.disconnect(!0,!1),document.visibilityState==="visible"&&this.reconnect()}send(t){this.clearKeepAliveTimer();const n=Date.now(),r=setTimeout(this.verifySend.bind(this,n),this.timeout);return this.verifications.push(r),this.setupKeepAliveTimer(),this.socket.write(t+A.statementDelimiter)}verifySend(t){if(Number(this.lastReceivedTimestamp)<t){if(this.status===v.DISCONNECTED||this.status===v.DISCONNECTING){m.errors(`Tried to verify already disconnected connection to '${this.hostIdentifier}'`);return}this.clearKeepAliveTimer(),m.network(`Connection to '${this.hostIdentifier}' timed out.`),this.socket.disconnect()}}onSocketConnect(){this.clearReconnectTimer(),this.lastReceivedTimestamp=Date.now(),this.setupKeepAliveTimer(),this.socket.removeAllListeners("error"),this.socket.on("error",this.onSocketError.bind(this))}onSocketDisconnect(){this.emit("disconnect"),this.clearKeepAliveTimer(),this.status===v.DISCONNECTING?(this.clearReconnectTimer(),this.removeAllListeners(),this.status=v.DISCONNECTED,m.network(`Disconnected from '${this.hostIdentifier}'.`)):(this.status===v.CONNECTED&&m.errors(`Connection with '${this.hostIdentifier}' was closed, trying to reconnect in ${this.reconnectInterval/1e3} seconds.`),this.status=v.DISCONNECTED,this.timers.reconnect||(this.timers.reconnect=setTimeout(this.reconnect.bind(this),this.reconnectInterval)))}onSocketError(t){if(!(typeof t>"u")){if(t.code==="EAI_AGAIN"){m.errors(`Failed to look up DNS records for '${this.host}'.`);return}if(t.code==="ETIMEDOUT"){m.errors(t.message);return}m.errors(`Unknown network error ('${this.hostIdentifier}'): `,t)}}}var tn=en;const nn=function(e){return"id"in e&&"error"in e},rn=function(e){return!("id"in e)&&"method"in e};class on extends fe.EventEmitter{constructor(t,n,r,i=g.PORT,s=g.TRANSPORT_SCHEME,c=g.TIMEOUT,f=g.PING_INTERVAL,h=g.RECONNECT,u=g.USE_BIG_INT){super(),this.subscriptionMethods={},this.requestId=0,this.requestResolvers={},this.connectionLock=new ze,this.connection=new tn(t,n,r,i,s,c,f,h,u)}async connect(){const t=await this.connectionLock.acquire();try{if(this.connection.status===v.CONNECTED)return;this.connection.on("statement",this.response.bind(this)),this.connection.on("connect",this.resubscribeOnConnect.bind(this)),this.connection.on("connect",this.emit.bind(this,"connected")),this.connection.on("disconnect",this.onConnectionDisconnect.bind(this)),this.connection.on("error",this.emit.bind(this,"error")),await this.connection.connect()}finally{t()}}async disconnect(t=!1,n=!1){const r=await this.connectionLock.acquire();try{n||(this.removeAllListeners(),this.subscriptionMethods={});for(const i in this.requestResolvers){const s=this.requestResolvers[i];s(new Error("Manual disconnection")),delete this.requestResolvers[i]}return await this.connection.disconnect(t)}finally{r()}}async request(t,...n){if(this.connection.status!==v.CONNECTED)throw new Error(`Unable to send request to a disconnected server '${this.connection.host}'.`);this.requestId+=1;const r=this.requestId,i=A.buildRequestObject(t,n,r),s=c=>{this.requestResolvers[r]=(f,h)=>{c(f||h)},this.connection.send(i)};return m.network(`Sending request '${t}' to '${this.connection.host}'`),new Promise(s)}async subscribe(t,...n){this.subscriptionMethods[t]||(this.subscriptionMethods[t]=new Set),this.subscriptionMethods[t].add(JSON.stringify(n));const r=await this.request(t,...n),i={jsonrpc:"2.0",method:t,params:[...n,r]};this.emit("notification",i)}async unsubscribe(t,...n){if(this.connection.status!==v.CONNECTED)throw new Error(`Unable to send unsubscribe request to a disconnected server '${this.connection.host}'.`);if(!this.subscriptionMethods[t])throw new Error(`Cannot unsubscribe from '${t}' since the method has no subscriptions.`);const r=JSON.stringify(n);if(!this.subscriptionMethods[t].has(r))throw new Error(`Cannot unsubscribe from '${t}' since it has no subscription with the given parameters.`);this.subscriptionMethods[t].delete(r),await this.request(t.replace(".subscribe",".unsubscribe"),...n),m.client(`Unsubscribed from '${String(t)}' for the '${r}' parameters.`)}async resubscribeOnConnect(){m.client(`Connected to '${this.connection.hostIdentifier}'.`);const t=[];for(const n in this.subscriptionMethods){for(const r of this.subscriptionMethods[n].values()){const i=JSON.parse(r);t.push(this.subscribe(n,...i))}await Promise.all(t)}t.length>0&&m.client(`Restored ${t.length} previous subscriptions for '${this.connection.hostIdentifier}'`)}response(t){if(rn(t)){m.client(`Received notification for '${t.method}' from '${this.connection.host}'`),this.emit("notification",t);return}if(t.id===null)throw new Error("Internal error: Received an RPC response with ID null.");const n=this.requestResolvers[t.id];if(!n)throw new Error("Internal error: Callback for response not available.");delete this.requestResolvers[t.id],nn(t)?n(new Error(t.error.message)):n(void 0,t.result)}onConnectionDisconnect(){this.emit("disconnected");for(const t in this.requestResolvers){const n=this.requestResolvers[t];n(new Error("Connection lost")),delete this.requestResolvers[t]}}}var sn=on;export{sn as $,C as a};
//# sourceMappingURL=index.BlhyKZba.js.map
