{"version":3,"file":"8.C4atcyB8.js","sources":["../../../../../../src/routes/write/+page.ts","../../../../../../src/routes/write/+page.svelte"],"sourcesContent":["import { dev } from '$app/environment';\n\n// we don't need any JS on this page, though we'll load\n// it in dev so that we get hot module replacement\nexport const csr = dev;\n\n// since there's no dynamic data here, we can prerender\n// it so that it gets served as a static asset in production\nexport const prerender = true;\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport { Vault, getFutureBlockDate } from '@fbch/lib';\n\timport SeriesIcon from '$lib/images/SeriesIcon.svelte';\n\timport { height } from '$lib/store.js';\n\tconst series = [3, 4, 5, 6];\n\tlet s = 4;\n\tlet coupons = [];\n\tlet duplicateCoupons = 1;\n\tlet placement = 1;\n\tlet rate = 20;\n\tlet totalSpend = 0;\n\tlet totalPlacement = 0;\n\tlet heightValue = 857000;\n\n\theight.subscribe((value: any) => {\n\t\theightValue = value;\n\t});\n\n\tfunction updateCoupons() {\n\t\tlet addresses = Vault.getCouponSeries(heightValue, placement * 1e8, s, s == 6 ? 4 : undefined);\n\t\tlet times = Vault.getSeriesTimes(heightValue, s, s == 6 ? 4 : undefined);\n\n\t\tcoupons = addresses\n\t\t\t.map(function (a, i) {\n\t\t\t\tif ((times[i] - heightValue) * rate > 543) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t...Array(duplicateCoupons).fill({\n\t\t\t\t\t\t\t\ttime: times[i],\n\t\t\t\t\t\t\t\taddress: a,\n\t\t\t\t\t\t\t\tplacement: placement,\n\t\t\t\t\t\t\t\tamount: Math.floor((times[i] - heightValue) * rate) / 1e8\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t];\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t})\n\t\t\t.flat();\n\n\t\n\n\t\ttotalPlacement = coupons.reduce(function (acc, obj) {\n\t\t\treturn acc + obj.placement;\n\t\t}, 0);\n\n\t\ttotalSpend = coupons.reduce(function (acc, obj) {\n\t\t\treturn acc + obj.amount;\n\t\t}, 0);\n\t\ttotalSpend = Math.floor(totalSpend * 1e8) / 1e8;\n\t}\n\n\tonMount(async () => {\n\t\tupdateCoupons();\n\t});\n</script>\n\n<svelte:head>\n\t<title>Write</title>\n\t<meta name=\"description\" content=\"Write Coupons\" />\n</svelte:head>\n\n<div class=\"text-column\">\n\t<h1>Write coupons</h1>\n\t<div id=\"control\">\n\t\t<div>Placement: 1 BCH</div>\n\t\t<div>\n\t\t\t<label>\n\t\t\t\tRate: {rate} spb<br />\n\t\t\t\t<input\n\t\t\t\t\ttype=\"range\"\n\t\t\t\t\ton:change={() => updateCoupons()}\n\t\t\t\t\tbind:value={rate}\n\t\t\t\t\tmin=\"1\"\n\t\t\t\t\tstep=\"0.2\"\n\t\t\t\t\tmax=\"50\"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t</div>\n\t\t<div>\n\t\t\t<label>\n\t\t\t\tCopies: {duplicateCoupons}<br />\n\t\t\t\t<input\n\t\t\t\t\ttype=\"range\"\n\t\t\t\t\ton:change={() => updateCoupons()}\n\t\t\t\t\tbind:value={duplicateCoupons}\n\t\t\t\t\tmin=\"1\"\n\t\t\t\t\tmax=\"40\"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t</div>\n\n\t\t<div>\n\t\t\t{#each series as number}\n\t\t\t\t<label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tname=\"s\"\n\t\t\t\t\t\tvalue={number}\n\t\t\t\t\t\tbind:group={s}\n\t\t\t\t\t\ton:change={() => updateCoupons()}\n\t\t\t\t\t/>\n\t\t\t\t\tVaults E{number} - {Math.pow(10, number)} <br />\n\t\t\t\t</label>\n\t\t\t{/each}\n\t\t</div>\n\t</div>\n\n\t<div>\n\t\tIncentivize locking up to {totalPlacement} BCH\n\t</div>\n\t<div id=\"total\">\n\t\tTotal: {totalSpend} BCH<br />\n\t</div>\n\t<hr />\n\t<div id=\"mono\">\n\t\t{#each coupons as c}\n\t\t\t{c.address}, {c.amount}<br />\n\t\t{/each}\n\t</div>\n</div>\n\n<style>\n\t#control {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t}\n\t#control div {\n\t\tflex: 1 0 30%;\n\t\tborder: 1px solid black;\n\t\tpadding: 0.2em;\n\t}\n\t#mono {\n\t\tfont-family: monospace;\n\t}\n\t#total {\n\t\ttext-align: right;\n\t}\n</style>\n"],"names":["csr","dev","prerender","ctx","t3_value","insert_hydration","target","label","anchor","append_hydration","input","br","t0_value","t2_value","dirty","set_data","t0","t2","i","meta","div8","h1","div4","div0","div1","label0","br0","input0","div2","label1","br1","input1","div3","div5","div6","br2","hr","div7","placement","series","s","coupons","duplicateCoupons","rate","totalSpend","totalPlacement","heightValue","height","value","updateCoupons","addresses","Vault","times","$$invalidate","a","acc","obj","onMount","to_number"],"mappings":"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"}